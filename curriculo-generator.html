<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">    <title>Gerador de Curr√≠culo | Portfolio Mikael</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="assets/css/curriculo-generator-styles.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        // Suprimir aviso de produ√ß√£o do Tailwind CDN
        if (typeof window !== 'undefined' && window.console) {
            const originalWarn = console.warn;
            console.warn = function(...args) {
                if (typeof args[0] === 'string' && args[0].includes('Tailwind')) {
                    return;
                }
                originalWarn.apply(console, args);
            };
        }
        
        // Configura√ß√£o do Tailwind
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#3B82F6',
                        secondary: '#1E40AF',
                        accent: '#F59E0B',
                    }
                }
            }
        }
    </script>
</head>
<body class="bg-gray-100 min-h-screen">
    <!-- Header -->
    <header class="bg-white shadow-lg border-b-4 border-primary">
        <div class="container mx-auto px-4 py-4">
            <div class="flex justify-between items-center">
                <div class="flex items-center space-x-4">
                    <i class="fas fa-file-alt text-3xl text-primary"></i>
                    <h1 class="text-2xl font-bold text-gray-800">Gerador de Curr√≠culo</h1>
                </div>                <div class="flex items-center space-x-2">
                    <button onclick="saveCurriculum()" class="bg-blue-500 hover:bg-blue-600 text-white px-3 py-2 rounded-lg transition text-sm">
                        <i class="fas fa-cloud-upload-alt mr-1"></i>Salvar
                    </button>
                    <button onclick="loadCurriculum()" class="bg-purple-500 hover:bg-purple-600 text-white px-3 py-2 rounded-lg transition text-sm">
                        <i class="fas fa-cloud-download-alt mr-1"></i>Carregar
                    </button>
                    <button onclick="exportToPDF()" class="bg-red-500 hover:bg-red-600 text-white px-3 py-2 rounded-lg transition text-sm">
                        <i class="fas fa-file-pdf mr-1"></i>PDF
                    </button>
                    <button onclick="saveToHtml()" class="bg-green-500 hover:bg-green-600 text-white px-3 py-2 rounded-lg transition text-sm">
                        <i class="fas fa-save mr-1"></i>HTML
                    </button>
                    <a href="admin.html" class="bg-gray-500 hover:bg-gray-600 text-white px-3 py-2 rounded-lg transition text-sm">
                        <i class="fas fa-cog mr-1"></i>Admin
                    </a>
                </div>
                        <i class="fas fa-arrow-left mr-2"></i>Voltar
                    </a>
                </div>
            </div>
        </div>
    </header>

    <div class="container mx-auto px-4 py-8">
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
            <!-- Painel de Controle -->
            <div class="bg-white rounded-lg shadow-lg p-6">
                <h2 class="text-xl font-bold mb-6 text-gray-800">
                    <i class="fas fa-cogs mr-2 text-primary"></i>Configura√ß√µes
                </h2>

                <!-- Tema -->
                <div class="mb-6">
                    <label class="block text-sm font-medium text-gray-700 mb-2">Tema do Curr√≠culo</label>
                    <select id="themeSelector" onchange="changeTheme()" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent">
                        <option value="modern">Moderno</option>
                        <option value="classic">Cl√°ssico</option>
                        <option value="creative">Criativo</option>
                        <option value="minimal">Minimalista</option>
                        <option value="tech">Tecnol√≥gico</option>
                    </select>
                </div>

                <!-- Se√ß√µes do Site -->
                <div class="mb-6">
                    <label class="block text-sm font-medium text-gray-700 mb-3">Incluir Informa√ß√µes de:</label>
                    <div class="space-y-2">
                        <label class="flex items-center">
                            <input type="checkbox" id="include-github" checked class="mr-2 text-primary">
                            <span>Perfil GitHub e Reposit√≥rios</span>
                        </label>
                        <label class="flex items-center">
                            <input type="checkbox" id="include-certificates" checked class="mr-2 text-primary">
                            <span>Certificados em Progresso</span>
                        </label>
                        <label class="flex items-center">
                            <input type="checkbox" id="include-projects" checked class="mr-2 text-primary">
                            <span>Projetos</span>
                        </label>
                        <label class="flex items-center">
                            <input type="checkbox" id="include-games" checked class="mr-2 text-primary">
                            <span>Jogos Desenvolvidos</span>
                        </label>
                        <label class="flex items-center">
                            <input type="checkbox" id="include-interactive" checked class="mr-2 text-primary">
                            <span>Projetos Interativos</span>
                        </label>
                        <label class="flex items-center">
                            <input type="checkbox" id="include-mentors" class="mr-2 text-primary">
                            <span>Mentores e Influ√™ncias</span>
                        </label>
                        <label class="flex items-center">
                            <input type="checkbox" id="include-skills" checked class="mr-2 text-primary">
                            <span>Habilidades T√©cnicas</span>
                        </label>
                    </div>
                </div>

                <!-- Informa√ß√µes Pessoais -->
                <div class="mb-6">
                    <h3 class="text-lg font-semibold mb-3 text-gray-800">Informa√ß√µes Pessoais</h3>
                    <div class="space-y-3">
                        <input type="text" id="personalName" placeholder="Nome Completo" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent">
                        <input type="email" id="personalEmail" placeholder="E-mail" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent">
                        <input type="tel" id="personalPhone" placeholder="Telefone" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent">
                        <input type="text" id="personalLocation" placeholder="Localiza√ß√£o" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent">
                        <textarea id="personalBio" placeholder="Biografia/Resumo Profissional" rows="4" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent"></textarea>
                    </div>
                </div>                <!-- Configura√ß√µes de Layout -->
                <div class="mb-6">
                    <h3 class="text-lg font-semibold mb-3 text-gray-800">Layout</h3>
                    <div class="space-y-3">
                        <label class="flex items-center">
                            <input type="checkbox" id="showPhoto" class="mr-2 text-primary">
                            <span>Incluir Foto do GitHub</span>
                        </label>
                        <label class="flex items-center">
                            <input type="checkbox" id="twoColumns" checked class="mr-2 text-primary">
                            <span>Layout de Duas Colunas</span>
                        </label>
                        <label class="flex items-center">
                            <input type="checkbox" id="showIcons" checked class="mr-2 text-primary">
                            <span>Mostrar √çcones</span>
                        </label>                        <label class="flex items-center">
                            <input type="checkbox" id="showColors" checked class="mr-2 text-primary">
                            <span>Usar Cores do Tema</span>
                        </label>
                    </div>
                </div>

                <!-- Firebase Status -->
                <div class="mb-6">
                    <h3 class="text-lg font-semibold mb-3 text-gray-800">Status Firebase</h3>
                    <div id="firebase-status" class="p-3 rounded-lg border">
                        <div class="flex items-center">
                            <div id="firebase-indicator" class="w-3 h-3 rounded-full bg-yellow-500 mr-2"></div>
                            <span id="firebase-text">Conectando...</span>
                        </div>
                        <div class="mt-2 text-sm">
                            <button onclick="checkFirebaseStatus()" class="bg-blue-500 text-white px-3 py-1 rounded text-xs hover:bg-blue-600">
                                Verificar Status
                            </button>                            <button onclick="window.testFirebaseSave()" class="bg-green-500 text-white px-3 py-1 rounded text-xs hover:bg-green-600 ml-2">
                                Testar Salvar
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Modo Edi√ß√£o Avan√ßada -->
                <div class="mb-6 p-4 bg-yellow-50 border border-yellow-200 rounded-lg">
                    <label class="flex items-center mb-3">
                        <input type="checkbox" id="editMode" class="mr-2 text-yellow-600 focus:ring-yellow-500">
                        <span class="text-sm font-medium text-yellow-800">
                            <i class="fas fa-magic mr-1"></i>Modo Edi√ß√£o Avan√ßada
                        </span>
                    </label>
                    <div id="editModeTools" class="hidden space-y-4">
                        <!-- Ferramentas R√°pidas -->
                        <div class="grid grid-cols-2 gap-2">
                            <button onclick="addCustomSection()" class="px-3 py-2 bg-blue-500 text-white text-xs rounded hover:bg-blue-600 transition">
                                <i class="fas fa-plus mr-1"></i>Nova Se√ß√£o
                            </button>
                            <button onclick="addCustomSkill()" class="px-3 py-2 bg-green-500 text-white text-xs rounded hover:bg-green-600 transition">
                                <i class="fas fa-code mr-1"></i>Nova Skill
                            </button>
                            <button onclick="addCustomProject()" class="px-3 py-2 bg-purple-500 text-white text-xs rounded hover:bg-purple-600 transition">
                                <i class="fas fa-project-diagram mr-1"></i>Projeto
                            </button>
                            <button onclick="addCustomExperience()" class="px-3 py-2 bg-orange-500 text-white text-xs rounded hover:bg-orange-600 transition">
                                <i class="fas fa-briefcase mr-1"></i>Experi√™ncia
                            </button>
                        </div>
                        
                        <!-- Controles de Personaliza√ß√£o -->
                        <div class="border-t pt-3">
                            <label class="block text-xs font-medium text-gray-700 mb-2">Tamanho da Fonte</label>
                            <input type="range" id="fontSize" min="10" max="20" value="14" 
                                   class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer">
                            <div class="flex justify-between text-xs text-gray-500 mt-1">
                                <span>10px</span>
                                <span id="fontSizeValue">14px</span>
                                <span>20px</span>
                            </div>
                        </div>
                        
                        <div class="grid grid-cols-2 gap-3">
                            <div>
                                <label class="block text-xs font-medium text-gray-700 mb-1">Cor Principal</label>
                                <input type="color" id="primaryColor" value="#3B82F6" 
                                       class="w-full h-8 border border-gray-300 rounded cursor-pointer">
                            </div>
                            <div>
                                <label class="block text-xs font-medium text-gray-700 mb-1">Cor Secund√°ria</label>
                                <input type="color" id="secondaryColor" value="#1E40AF" 
                                       class="w-full h-8 border border-gray-300 rounded cursor-pointer">
                            </div>
                        </div>
                        
                        <!-- Configura√ß√µes Avan√ßadas -->
                        <div class="space-y-2">
                            <label class="flex items-center text-xs">
                                <input type="checkbox" id="useGradients" class="mr-2">
                                <span>Usar gradientes nos cabe√ßalhos</span>
                            </label>
                            <label class="flex items-center text-xs">
                                <input type="checkbox" id="useShadows" checked class="mr-2">
                                <span>Adicionar sombras</span>
                            </label>
                            <label class="flex items-center text-xs">
                                <input type="checkbox" id="useAnimations" class="mr-2">
                                <span>Ativar anima√ß√µes (para web)</span>
                            </label>
                        </div>
                    </div>
                </div>                <!-- Bot√µes de A√ß√£o -->
                <div class="space-y-3">
                    <button onclick="generateResume()" class="w-full bg-primary hover:bg-secondary text-white py-3 rounded-lg transition font-semibold">
                        <i class="fas fa-magic mr-2"></i>Gerar Curr√≠culo
                    </button>
                    <button onclick="loadGitHubData()" class="w-full bg-accent hover:bg-yellow-600 text-white py-3 rounded-lg transition font-semibold">
                        <i class="fab fa-github mr-2"></i>Carregar Dados do GitHub
                    </button>
                    
                    <!-- Bot√µes Secund√°rios -->
                    <div class="grid grid-cols-2 gap-3">
                        <button onclick="previewInNewTab()" class="bg-indigo-500 hover:bg-indigo-600 text-white px-4 py-2 rounded-lg transition text-sm">
                            <i class="fas fa-external-link-alt mr-1"></i>Preview
                        </button>
                        <button onclick="saveTemplate()" class="bg-teal-500 hover:bg-teal-600 text-white px-4 py-2 rounded-lg transition text-sm">
                            <i class="fas fa-bookmark mr-1"></i>Salvar Modelo
                        </button>
                    </div>
                    
                    <div class="grid grid-cols-2 gap-3">
                        <button onclick="loadTemplate()" class="bg-purple-500 hover:bg-purple-600 text-white px-4 py-2 rounded-lg transition text-sm">
                            <i class="fas fa-folder-open mr-1"></i>Carregar Modelo
                        </button>
                        <button onclick="resetForm()" class="bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-lg transition text-sm">
                            <i class="fas fa-redo mr-1"></i>Reset
                        </button>
                    </div>
                </div>
            </div>

            <!-- Visualiza√ß√£o do Curr√≠culo -->
            <div class="bg-white rounded-lg shadow-lg p-6">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-xl font-bold text-gray-800">
                        <i class="fas fa-eye mr-2 text-primary"></i>Visualiza√ß√£o
                    </h2>
                    <button onclick="toggleEditMode()" id="editModeBtn" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg transition">
                        <i class="fas fa-edit mr-2"></i>Modo Edi√ß√£o
                    </button>
                </div>                <!-- Preview Area -->
                <div id="resumePreview" class="border border-gray-300 rounded-lg p-6 min-h-96 bg-white theme-modern">
                    <div class="text-center text-gray-500 py-20">
                        <i class="fas fa-file-alt text-6xl mb-4"></i>
                        <p class="text-lg">Clique em "Gerar Curr√≠culo" para visualizar</p>
                        <p class="text-sm mt-2 text-gray-400">Status: Aguardando dados...</p>
                    </div>
                </div>
                
                <!-- Debug Console (remover em produ√ß√£o) -->
                <div id="debugConsole" class="mt-4 p-4 bg-gray-100 rounded-lg text-xs" style="display: none;">
                    <h4 class="font-bold mb-2">Debug Console:</h4>
                    <div id="debugMessages" class="space-y-1 max-h-32 overflow-y-auto"></div>
                    <button onclick="document.getElementById('debugConsole').style.display='none'" class="mt-2 text-red-600 hover:text-red-800">Fechar Debug</button>
                </div>
                
                <!-- Bot√£o para mostrar debug -->
                <button onclick="document.getElementById('debugConsole').style.display='block'" class="mt-2 text-xs text-gray-500 hover:text-gray-700">
                    üîß Mostrar Debug
                </button>
            </div>
        </div>
    </div>    <!-- Loading Modal -->
    <div id="loadingModal" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center z-50">
        <div class="bg-white rounded-lg p-8 text-center">
            <div class="animate-spin rounded-full h-16 w-16 border-b-2 border-primary mx-auto mb-4"></div>
            <p class="text-lg font-semibold">Carregando dados...</p>
        </div>
    </div>

    <!-- Modal para Adicionar Conte√∫do Personalizado -->
    <div id="customContentModal" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center z-50 p-4">
        <div class="bg-white rounded-lg p-6 w-full max-w-lg max-h-96 overflow-y-auto">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-lg font-bold">Adicionar Conte√∫do Personalizado</h3>
                <button onclick="closeCustomModal()" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div id="customContentForm" class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Tipo de Conte√∫do</label>
                    <select id="customContentType" class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                        <option value="section">Nova Se√ß√£o</option>
                        <option value="skill">Habilidade</option>
                        <option value="project">Projeto</option>
                        <option value="experience">Experi√™ncia</option>
                        <option value="education">Educa√ß√£o</option>
                        <option value="certification">Certifica√ß√£o</option>
                    </select>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">T√≠tulo</label>
                    <input type="text" id="customTitle" class="w-full px-3 py-2 border border-gray-300 rounded-lg" placeholder="Digite o t√≠tulo...">
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Descri√ß√£o</label>
                    <textarea id="customDescription" rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-lg resize-none" placeholder="Digite a descri√ß√£o..."></textarea>
                </div>
                
                <div id="customFields" class="space-y-2">
                    <!-- Campos din√¢micos baseados no tipo selecionado -->
                </div>
                
                <div class="flex space-x-3 pt-4">
                    <button onclick="addCustomContent()" class="flex-1 bg-primary hover:bg-secondary text-white py-2 rounded-lg transition">
                        <i class="fas fa-plus mr-2"></i>Adicionar
                    </button>
                    <button onclick="closeCustomModal()" class="flex-1 bg-gray-500 hover:bg-gray-600 text-white py-2 rounded-lg transition">
                        Cancelar
                    </button>
                </div>
            </div>
        </div>
    </div>    <!-- Scripts -->
    <script type="module">
        // Prote√ß√£o administrativa - verificar autentica√ß√£o antes de carregar
        import { checkAuth, doLogout } from './assets/js/auth.js';
        
        // Verificar se usu√°rio est√° autenticado IMEDIATAMENTE
        document.addEventListener('DOMContentLoaded', function() {
            // Esconder conte√∫do inicialmente
            document.body.style.visibility = 'hidden';
            
            checkAuth().then(user => {
                console.log('Acesso autorizado para:', user.email);
                // Se chegou at√© aqui, usu√°rio est√° autenticado
                document.body.style.visibility = 'visible';
                initializePage();
            }).catch(error => {
                console.log('Acesso negado:', error);
                // Redirecionar para login se n√£o estiver autenticado
                window.location.href = './login.html';
            });
        });
        
        // Fun√ß√£o para inicializar a p√°gina ap√≥s autentica√ß√£o
        function initializePage() {
            // Adicionar bot√£o de logout
            const container = document.querySelector('.container');
            if (container) {
                const logoutBtn = document.createElement('div');
                logoutBtn.className = 'text-right mb-4 p-4 bg-red-50 border border-red-200 rounded-lg';
                logoutBtn.innerHTML = `
                    <div class="flex justify-between items-center">
                        <span class="text-sm text-red-700">
                            <i class="fas fa-shield-alt mr-2"></i>√Årea Administrativa
                        </span>
                        <button onclick="handleLogout()" class="bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg transition">
                            <i class="fas fa-sign-out-alt mr-2"></i>Logout
                        </button>
                    </div>
                `;
                container.insertBefore(logoutBtn, container.firstChild);
            }
        }
          // Fun√ß√£o global para logout
        window.handleLogout = function() {
            if (confirm('Tem certeza que deseja sair?')) {
                doLogout();
            }
        };

        // Fun√ß√µes para testar Firebase
        function checkFirebaseStatus() {
            const status = getFirebaseStatus();
            updateFirebaseUI(status);
        }

        function updateFirebaseUI(status) {
            const indicator = document.getElementById('firebase-indicator');
            const text = document.getElementById('firebase-text');
            
            if (status.connected) {
                indicator.className = 'w-3 h-3 rounded-full bg-green-500 mr-2';
                text.textContent = `Conectado (${status.userId?.substring(0, 8)}...)`;
            } else {
                indicator.className = 'w-3 h-3 rounded-full bg-red-500 mr-2';
                text.textContent = status.message || 'Desconectado';
            }
        }

        async function testFirebaseSave() {
            const button = event.target;
            const originalText = button.textContent;
            
            button.textContent = 'Salvando...';
            button.disabled = true;
            
            try {
                const result = await saveCurriculum();
                
                if (result && result.success) {
                    alert('‚úÖ Teste de salvamento bem-sucedido!');
                } else {
                    alert('‚ö†Ô∏è Salvamento offline ou com erro: ' + (result?.error || 'Erro desconhecido'));
                }
            } catch (error) {
                alert('‚ùå Erro no teste: ' + error.message);
            } finally {
                button.textContent = originalText;
                button.disabled = false;
                checkFirebaseStatus();
            }
        }

        // Verificar status do Firebase periodicamente
        setInterval(checkFirebaseStatus, 5000);
        
        // Verificar status inicial ap√≥s carregamento
        setTimeout(checkFirebaseStatus, 2000);
    </script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
      <!-- Firebase Scripts -->
    <script type="module" src="assets/js/curriculum-firebase.js"></script>
    <script type="module" src="assets/js/curriculo-generator.js"></script>
    
    <!-- C√≥digo que depende dos m√≥dulos carregados -->
    <script>
        // Aguardar carregamento dos m√≥dulos antes de definir fun√ß√µes globais
        setTimeout(() => {
            // Fun√ß√£o de teste do Firebase
            window.testFirebaseSave = async function() {
                const button = event.target;
                const originalText = button.textContent;
                button.textContent = 'Salvando...';
                button.disabled = true;
                
                try {
                    if (typeof saveCurriculum === 'function') {
                        const result = await saveCurriculum();
                        
                        if (result && result.success) {
                            alert('‚úÖ Teste de salvamento bem-sucedido!');
                        } else {
                            alert('‚ö†Ô∏è Salvamento offline ou com erro: ' + (result?.error || 'Erro desconhecido'));
                        }
                    } else {
                        alert('‚ùå Fun√ß√£o saveCurriculum n√£o dispon√≠vel');
                    }
                } catch (error) {
                    alert('‚ùå Erro no teste: ' + error.message);
                    console.error('Erro completo:', error);
                } finally {
                    button.textContent = originalText;
                    button.disabled = false;
                    setTimeout(checkFirebaseStatus, 500);
                }
            };

            // Fun√ß√£o para verificar status do Firebase
            window.checkFirebaseStatus = function() {
                const statusElement = document.getElementById('firebase-status');
                if (statusElement && typeof getFirebaseStatus === 'function') {
                    try {
                        const status = getFirebaseStatus();
                        statusElement.textContent = status;
                        statusElement.className = status.includes('Conectado') || status.includes('‚úÖ') ? 
                            'text-green-600' : 'text-red-600';
                    } catch (error) {
                        statusElement.textContent = 'Erro no status';
                        statusElement.className = 'text-red-600';
                        console.error('Erro ao verificar status:', error);
                    }
                } else {
                    console.warn('getFirebaseStatus n√£o dispon√≠vel ou elemento n√£o encontrado');
                }
            };

            // Verificar status do Firebase periodicamente
            setInterval(checkFirebaseStatus, 5000);
            
            // Verificar status inicial
            setTimeout(checkFirebaseStatus, 1000);
            
        }, 1000); // Aguardar 1 segundo para os m√≥dulos carregarem
    </script>
</body>
</html>
